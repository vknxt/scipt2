-- Carrega a UI Library
local Lib = loadstring(game:HttpGet("https://raw.githubusercontent.com/7yhx/kwargs_Ui_Library/main/source.lua"))()
local UI = Lib:Create{
    Theme = "Dark", 
    Size = UDim2.new(0, 555, 0, 400),
    Title = "⭐ ESP & Aimbot Premium ⭐"
}

-- Cria abas na interface
local MenuPrincipal = UI:Tab{ Name = "🎯 Principal" }
local SecaoESP = MenuPrincipal:Section{ Name = "👁️ Configurações ESP", Column = 1 }
local SecaoAimbot = MenuPrincipal:Section{ Name = "🎯 Configurações Aimbot", Column = 2 }

-- Adiciona título e descrição
MenuPrincipal:Label{ Text = "✨ Bem-vindo ao ESP & Aimbot Premium ✨" }
MenuPrincipal:Label{ Text = "💫 Personalize as configurações para a melhor experiência:" }

-- Variáveis de controle
_G.espAtivado = false
_G.aimbotAtivado = false
local corESP = Color3.fromRGB(255, 0, 0) -- Vermelho por padrão
local tamanhoESP = Vector3.new(4, 6, 1)
local sensibilidadeAimbot = 0.5

-- Função para desenhar ESP
local function desenharESP(jogador)
    if jogador and jogador ~= game.Players.LocalPlayer and jogador.Character then
        -- Remove ESP existente
        for _, v in pairs(jogador.Character:GetChildren()) do
            if v:IsA("BoxHandleAdornment") or v:IsA("BillboardGui") then
                v:Destroy()
            end
        end
        
        -- Cria nova caixa ESP
        local caixa = Instance.new("BoxHandleAdornment")
        caixa.Size = tamanhoESP
        caixa.Adornee = jogador.Character
        caixa.Color3 = corESP
        caixa.AlwaysOnTop = true
        caixa.ZIndex = 10
        caixa.Transparency = 0.3
        caixa.Parent = jogador.Character
        
        -- Adiciona nome do jogador
        local painelNome = Instance.new("BillboardGui")
        painelNome.Size = UDim2.new(0, 100, 0, 40)
        painelNome.StudsOffset = Vector3.new(0, 3, 0)
        painelNome.Adornee = jogador.Character.Head
        painelNome.Parent = jogador.Character

        local textoNome = Instance.new("TextLabel")
        textoNome.Size = UDim2.new(1, 0, 1, 0)
        textoNome.BackgroundTransparency = 1
        textoNome.TextColor3 = corESP
        textoNome.Text = jogador.Name
        textoNome.TextScaled = true
        textoNome.Parent = painelNome
    end
end

-- Função para atualizar ESP
local function atualizarESP()
    while _G.espAtivado do
        for _, jogador in pairs(game.Players:GetPlayers()) do
            if jogador ~= game.Players.LocalPlayer then
                desenharESP(jogador)
            end
        end
        wait(0.1)
    end
end

-- Função de aimbot
local function aimbot()
    while _G.aimbotAtivado do
        local jogadorMaisProximo = nil
        local menorDistancia = math.huge
        local jogadorLocal = game.Players.LocalPlayer
        
        if jogadorLocal.Character and jogadorLocal.Character:FindFirstChild("HumanoidRootPart") then
            for _, jogador in pairs(game.Players:GetPlayers()) do
                if jogador ~= jogadorLocal and jogador.Character and 
                   jogador.Character:FindFirstChild("Head") and 
                   jogador.Character:FindFirstChild("Humanoid") and
                   jogador.Character.Humanoid.Health > 0 then
                    
                    local distancia = (jogador.Character.Head.Position - jogadorLocal.Character.Head.Position).magnitude
                    if distancia < menorDistancia then
                        jogadorMaisProximo = jogador
                        menorDistancia = distancia
                    end
                end
            end

            if jogadorMaisProximo and jogadorMaisProximo.Character then
                local posicaoCabeca = jogadorMaisProximo.Character.Head.Position
                local framePosicaoAtual = jogadorLocal.Character.HumanoidRootPart.CFrame
                local frameAlvo = CFrame.new(framePosicaoAtual.Position, posicaoCabeca)
                
                -- Suavização do movimento
                jogadorLocal.Character.HumanoidRootPart.CFrame = framePosicaoAtual:Lerp(frameAlvo, sensibilidadeAimbot)
            end
        end
        wait(0.01)
    end
end

-- Botões e controles
SecaoESP:Toggle{
    Name = "🟢 Ativar ESP",
    Default = false,
    Callback = function(estado)
        _G.espAtivado = estado
        if estado then
            coroutine.wrap(atualizarESP)()
        else
            -- Limpa todas as caixas ESP
            for _, jogador in pairs(game.Players:GetPlayers()) do
                if jogador.Character then
                    for _, v in pairs(jogador.Character:GetChildren()) do
                        if v:IsA("BoxHandleAdornment") or v:IsA("BillboardGui") then
                            v:Destroy()
                        end
                    end
                end
            end
        end
    end
}

SecaoAimbot:Toggle{
    Name = "🎯 Ativar Aimbot",
    Default = false,
    Callback = function(estado)
        _G.aimbotAtivado = estado
        if estado then
            coroutine.wrap(aimbot)()
        end
    end
}

-- Configurações avançadas
SecaoESP:Slider{
    Name = "📏 Tamanho da Caixa ESP",
    Min = 1,
    Max = 10,
    Default = 4,
    Callback = function(valor)
        tamanhoESP = Vector3.new(valor, valor * 1.5, valor * 0.25)
    end
}

SecaoESP:ColorPicker{
    Name = "🎨 Cor do ESP",
    Default = Color3.fromRGB(255, 0, 0),
    Callback = function(cor)
        corESP = cor
    end
}

SecaoAimbot:Slider{
    Name = "⚡ Sensibilidade do Aimbot",
    Min = 0.1,
    Max = 1,
    Default = 0.5,
    Callback = function(valor)
        sensibilidadeAimbot = valor
    end
}

-- Adiciona informações extras
MenuPrincipal:Label{ Text = "⚠️ Use com responsabilidade! ⚠️" }
